
/*---
/js/bs/restProjectsPopup.js
---*/
BS.RestProjectsPopup=new BS.Popup("restProjectsPopup",{delay:0,hideOnMouseOut:false,doScroll:false,shift:{x:-100,y:15},htmlProvider:function(c){ReactUI.performCleanups(c.element().firstChild);c.element().textContent="";var b=document.createElement("div");b.style.minHeight="160px";var d=c.options.restPopupSettings;var f=d.parentProjectId;var a=d.currentId;var e=d.currentNodeType;if(f!=null){BS.RestProjectsPopup.addUrlFormats(d);}ReactUI.renderProjectsPopup(b,{parentProjectId:f,editMode:f!=null&&BS.Navigation.discoverMode().adminPart==true,activeItem:a!=null?{nodeType:e,id:a,group:"search"}:null,buildTypeUrlFormat:d.btUrlFormat,projectUrlFormat:d.projectUrlFormat});BS.Hider.addHideFunction(c._name,function(){ReactUI.performCleanups(b);c.element().textContent="";});return b;},backgroundColor:"white",loadingText:"Loading...",forceReload:true});BS.RestProjectsPopup.addUrlFormats=function(b){if(BS.Navigation.items==undefined||b==undefined||b.currentId==undefined){b.btUrlFormat=undefined;b.projectUrlFormat=undefined;return;}for(var a=0;a<BS.Navigation.items.length;a++){var c=BS.Navigation.items[a];if(c.buildTypeId==b.currentId||c.projectId==b.currentId){if(c.siblingsTree!=undefined){b.btUrlFormat=c.siblingsTree.buildTypeUrlFormat;b.projectUrlFormat=c.siblingsTree.projectUrlFormat;}break;}}};BS.RestProjectsPopup.globalSearchOptions=function(a){return{restPopupSettings:{parentProjectId:undefined,currentId:undefined,editMode:false,cache:BS.RestProjectsPopup.restProjectPopupCacheDisabled!=undefined&&BS.RestProjectsPopup.restProjectPopupCacheDisabled=="true"?"nocache":BS.RestProjectsPopup.restProjectPopupCacheStrategy!=undefined?BS.RestProjectsPopup.restProjectPopupCacheStrategy:"lzutf8"},delay:a!=undefined&&a.type=="mouseover"?300:0,doScroll:false,shift:{x:-75,y:15}};};BS.RestProjectsPopup.quickNavigationOptions=function(){return{restPopupSettings:{parentProjectId:undefined,currentId:undefined,editMode:false,cache:BS.RestProjectsPopup.restProjectPopupCacheDisabled!=undefined&&BS.RestProjectsPopup.restProjectPopupCacheDisabled=="true"?"nocache":BS.RestProjectsPopup.restProjectPopupCacheStrategy!=undefined?BS.RestProjectsPopup.restProjectPopupCacheStrategy:"lzutf8"},doScroll:false};};BS.RestProjectsPopup.breadcrumbsOptions=function(g,a,f,d,b,e,c){return{restPopupSettings:{parentProjectId:g,currentId:a,currentNodeType:f,editMode:d,branch:b,firstFocusValue:{id:a}},doScroll:false,shift:{x:e!=undefined?e:-10,y:c!=undefined?c:15}};};BS.RestProjectsPopup.hideCurrentPopIfAny=function(){if(BS.RestProjectsPopup.isShown()){BS.RestProjectsPopup.hidePopup(0,true);}};BS.RestProjectsPopup.showGlobal=function(a,b){BS.RestProjectsPopup.hideCurrentPopIfAny();BS.RestProjectsPopup.showPopupNearElement(a,BS.RestProjectsPopup.globalSearchOptions(b));};BS.RestProjectsPopup.showQuickNavigation=function(){BS.RestProjectsPopup.hideCurrentPopIfAny();_.extend(this.options,BS.RestProjectsPopup.quickNavigationOptions());BS.RestProjectsPopup._showWithDelay($j(document).width()/2-230,$j(document).scrollTop()+100,function(){});};BS.RestProjectsPopup.register=function(){var a=jQuery("#allPopupImg");a.on("mouseover",function(b){a.addClass("hovered");BS.RestProjectsPopup.showGlobal(a,b);}).on("mouseout",function(){a.removeClass("hovered");BS.RestProjectsPopup.hidePopup(1000);}).on("click",function(b){BS.RestProjectsPopup.showGlobal(a,b);b.stopPropagation();});a.removeClass("disabled");jQuery(document).on("keydown keyup",function(d){var c=d.originalEvent&&d.originalEvent.code;if((d.type==="keyup"&&(c==="KeyQ"||c==="KeyP"||d.key==="q"||d.key==="p")&&!BS.Util.isModifierKey(d))||(d.type==="keydown"&&(c==="KeyK"||d.key==="k")&&(d.ctrlKey||d.metaKey))){var b=jQuery(d.target);if(b.is("input")||b.is("textarea")||b.is("select")){return;}BS.RestProjectsPopup.showQuickNavigation();}});};BS.RestProjectsPopup.install=function(b,c,a){BS.RestProjectsPopup.restProjectPopupCacheStrategy=a;BS.RestProjectsPopup.restProjectPopupCacheDisabled=c;BS.RestProjectsPopup.register();};BS.RestProjectsPopup.installRestBreadcrumbs=function(){var b=$j("#restBreadcrumbs");var c=b.find("div[data-parentId], li[data-parentId]");var a=b.find('[data-projectid="_Root"]');if(a.length>0){c.push(a[0]);}var d=b.find("div[data-buildid]");if(d.length>0){c.push(d[0]);}c.each(function(g){var j=$j(this).attr("data-parentId");var e=$j(this).attr("data-projectid");var i="project";if(j==undefined||j==""){j=e;}if(e==undefined){e=$j(this).attr("data-buildtypeid");i="bt";}var h=$j(this);var f=h.find(".iWrapper");f.find("i").removeClass("icon_disabled");f.on("click",function(){if(BS.RestProjectsPopup&&!BS.RestProjectsPopup.isShown()){BS.RestProjectsPopup.showPopupNearElement(f,BS.RestProjectsPopup.breadcrumbsOptions(j,e,i,BS.Navigation.discoverMode().adminPart,undefined,-2,f.height()));}else{BS.RestProjectsPopup.stopHidingPopup();}});});};